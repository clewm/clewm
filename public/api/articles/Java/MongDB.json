{"title":"MongoDB","uid":"bf5af07f5bcdc26d4909303b36fb356e","slug":"Java/MongDB","date":"2022-07-14T02:40:19.176Z","updated":"2022-11-22T03:00:45.886Z","comments":true,"path":"api/articles/Java/MongDB.json","keywords":null,"cover":[],"content":"<h1 id=\"MongoDB\"><a href=\"#MongoDB\" class=\"headerlink\" title=\"MongoDB\"></a>MongoDB</h1><h2 id=\"概念\"><a href=\"#概念\" class=\"headerlink\" title=\"概念\"></a>概念</h2><p>一种非关系型数据库(NoSQL)</p>\n<p>应用场景：高并发的、需要低延时的，对事务要求、安全性不是很高的场景。</p>\n<h2 id=\"和Reids的区别？\"><a href=\"#和Reids的区别？\" class=\"headerlink\" title=\"和Reids的区别？\"></a>和Reids的区别？</h2><p>Redis主要把数据存储在内存中，其“缓存”的性质远大于其“数据存储“的性质，其中数据的增删改查也只是像变量操作一样简单；</p>\n<p>MongoDB却是一个“存储数据”的系统，增删改查可以添加很多条件，就像SQL数据库一样灵活，这一点在面试的时候很受用。</p>\n<h2 id=\"术语对比\"><a href=\"#术语对比\" class=\"headerlink\" title=\"术语对比\"></a>术语对比</h2><p><img src=\"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/image-20221122105852998.png\" alt=\"image-20221122105852998\"></p>\n<h2 id=\"Windows安装-启动\"><a href=\"#Windows安装-启动\" class=\"headerlink\" title=\"Windows安装/启动\"></a>Windows安装/启动</h2><p>下载zip格式的mongoDB包</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">https:&#x2F;&#x2F;www.mongodb.com&#x2F;try&#x2F;download&#x2F;community</code></pre>\n\n<p>下载之后解压，在根目录下创建文件夹data/db</p>\n<p><img src=\"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/image-20221122105904463.png\" alt=\"image-20221122105904463\"></p>\n<p>进入bin目录下进入cmd</p>\n<p>执行如下</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">mongod --dbpath&#x3D;..&#x2F;data&#x2F;db  #指定数据库存放位置</code></pre>\n\n<p>重新进入bin下的cmd，执行如下：</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">mongo 或者 mongo --host&#x3D;127.0.0.1 --port&#x3D;27017 #27017是默认端口号</code></pre>\n\n<h2 id=\"Linux安装-启动\"><a href=\"#Linux安装-启动\" class=\"headerlink\" title=\"Linux安装/启动\"></a>Linux安装/启动</h2><img src=\"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/image-20221122105922151.png\" alt=\"image-20221122105922151\" style=\"zoom:50%;\" />\n\n<p>配置内容如下：</p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\">systemLog:\n\t#MongoDB发送所有日志输出的目标指定为文件\n\t# #The path of the 1log file to which mongod or mongos should send all diagnostic 1ogging information\n\tdestination: file\n    #mongod或mongos应向其发送所有诊断日志记录信息的日志文件的路径\n    path: &quot;&#x2F;mongodb&#x2F;sing1e&#x2F;1og&#x2F;mongod. log&quot;\n    #当mongos或mongod实例重新启动时，mongos或mongod会将新条目附加到现有日志文件的末尾。\n    logAppend: true\nstorage:\n    #mongod实例存储其数据的目录。storage . dbpath设置仅适用于mongod.\n    ##The directory where the mongod instance stores its data. Default value is &quot;&#x2F;data&#x2F;db&quot;.\n    dbpath: &quot;&#x2F;mongodb&#x2F;sing1e&#x2F;data&#x2F;db&quot;\n    journal:\n        #启用或禁用持久性日志以确保数据文件保持有效和可恢复。\n        enabled: true\nprocessManagement:\n    #启用在后台运行mongos或mongod进程的守护进程模式。\n    fork: true\nnet:\n    #服务实例绑定的IP，默认是localhost\n    bindIp: 1oca1host,192.168.0.2\n    #绑定的端口，默认是27017\n    port: 27017</code></pre>\n\n<p>启动：</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">&#x2F;usr&#x2F;local&#x2F;mongodb&#x2F;bin&#x2F;mongod -f &#x2F;mongodb&#x2F;single&#x2F;mongod.conf</code></pre>\n\n<p>结果应该是Successfully</p>\n<p>然后就可以使用可视化工具或者Shell命令行进行连接，如果连接不上，尝试关闭防火墙</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">#查看防火墙状态 systemctl status firewalld \n#临时关闭防火墙 systemctl stop firewalld \n#开机禁止启动防火墙 systemctl disable firewalld</code></pre>\n\n<p>关闭数据库：</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">&#x2F;&#x2F;客户端登录服务，注意，这里通过localhost登录，如果需要远程登录，必须先登录认证才行。 \nmongo --port 27017 &#x2F;&#x2F;#切换到admin库 \nuse admin &#x2F;&#x2F;关闭服务 \ndb.shutdownServer()</code></pre>\n\n<h2 id=\"图形化界面\"><a href=\"#图形化界面\" class=\"headerlink\" title=\"图形化界面\"></a>图形化界面</h2><p>到官网下载Compass，直接运行即可</p>\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><h3 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h3><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">use 数据库名称 #选择&#x2F;创建\n\nshow dbs #查看数据库(磁盘里的)\n\ndb #查看正在使用的数据库\n\ndb.dropDatabase() #删除数据库 db指的是数据库对象，操作的是当前使用的数据库</code></pre>\n\n<h3 id=\"集合\"><a href=\"#集合\" class=\"headerlink\" title=\"集合\"></a>集合</h3><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.createCollection(&quot;My&quot;) #创建一个叫My的集合\n\nshow collections #查看所有集合\n\ndb.集合名.drop() #删除某个集合</code></pre>\n\n<h3 id=\"文档\"><a href=\"#文档\" class=\"headerlink\" title=\"文档\"></a>文档</h3><h5 id=\"文档的id值必须为字符串-不是数字\"><a href=\"#文档的id值必须为字符串-不是数字\" class=\"headerlink\" title=\"文档的id值必须为字符串!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!不是数字\"></a><strong>文档的id值必须为字符串!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!不是数字</strong></h5><h4 id=\"查询-插入\"><a href=\"#查询-插入\" class=\"headerlink\" title=\"查询/插入\"></a>查询/插入</h4><h5 id=\"普通查询\"><a href=\"#普通查询\" class=\"headerlink\" title=\"普通查询\"></a>普通查询</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.集合名.insert(&#123;&quot;name&quot;:&quot;value&quot;&#125;) #单条数据的插入，若此时集合未被创建，会隐式地创建好集合\n\ndb.集合名.insertMany([\n    &#123;\n        xxx:xxx\n    &#125;,\n    &#123;\n        xxx:xxx\n    &#125;,\n])  #插入多条数据\n\ndb.集合名.find() #查看集合内容\n\ndb.集合名.find(&#123;&quot;name&quot;:&quot;张三&quot;&#125;) #查询名字为张三的内容\n\ndb.集合名.findOne() &#x2F; db.集合名.findOne(&#123;xxx:xxx&#125;)#查询一条数据，类似于limit\n\ndb.集合名.find(&#123;查询的条件&#125;,&#123;字段1:1,字段2:0&#125;)#只显示部分字段,显示字段1，不显示字段2，以逗号分割</code></pre>\n\n<h5 id=\"统计查询-count\"><a href=\"#统计查询-count\" class=\"headerlink\" title=\"统计查询 count\"></a>统计查询 count</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.count() #查询所有数据数量\n\ndb.comment.count(&#123;条件&#125;)</code></pre>\n\n<h5 id=\"分页查询-limt-skip\"><a href=\"#分页查询-limt-skip\" class=\"headerlink\" title=\"分页查询 limt/skip\"></a>分页查询 limt/skip</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find().limit(3) #限制查询数量</code></pre>\n\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find().limit(2).skip(2)</code></pre>\n\n<h5 id=\"排序-sort\"><a href=\"#排序-sort\" class=\"headerlink\" title=\"排序 sort\"></a>排序 sort</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find().sort(&#123;xxx:1&#x2F;0&#125;) #1为升序，-1为降序</code></pre>\n\n<h5 id=\"正则查询\"><a href=\"#正则查询\" class=\"headerlink\" title=\"正则查询 / /\"></a>正则查询 / /</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find(&#123;字段:&#x2F;正则表达式&#x2F;&#125;)</code></pre>\n\n<h5 id=\"比较查询-gt-lt\"><a href=\"#比较查询-gt-lt\" class=\"headerlink\" title=\"比较查询 gt/lt\"></a>比较查询 gt/lt</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find(&#123;xxx:&#123;$gt:value&#125;&#125;)\n\ngt：大于\ngte：大于等于\n\nlt：小于\nlte：小于等于</code></pre>\n\n<h5 id=\"包含查询-in-nin\"><a href=\"#包含查询-in-nin\" class=\"headerlink\" title=\"包含查询 in/nin\"></a>包含查询 in/nin</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find(&#123;xxx:&#123;$in:[&quot;value1&quot;,&quot;value2&quot;]&#125;&#125;) #包含\n\ndb.comment.find(&#123;xxx:&#123;$nin:[&quot;value1&quot;,&quot;value2&quot;]&#125;&#125;) #不包含</code></pre>\n\n<h5 id=\"多条件查询-and-or\"><a href=\"#多条件查询-and-or\" class=\"headerlink\" title=\"多条件查询 and/or\"></a>多条件查询 and/or</h5><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find(&#123;$and:[&#123;&quot;xxx&quot;:&quot;value&quot;&#125;,&#123;&quot;xxx2&quot;:&#123;$gt:NumberInt(233)&#125;&#125;]&#125;)\n\n\ndb.comment.find(&#123;$or:[&#123;&quot;xxx&quot;:&quot;value&quot;&#125;,&#123;&quot;xxx2&quot;:&#123;$gt:NumberInt(233)&#125;&#125;]&#125;)</code></pre>\n\n\n\n<h4 id=\"Try-catch包裹插入语句\"><a href=\"#Try-catch包裹插入语句\" class=\"headerlink\" title=\"Try catch包裹插入语句\"></a>Try catch包裹插入语句</h4><p><img src=\"http://www.clewm.top/MarkDownImages/image-20220714132811240.png\" alt=\"image-20220714132811240\"></p>\n<p>可以知道哪条数据插入失败</p>\n<h4 id=\"更新\"><a href=\"#更新\" class=\"headerlink\" title=\"更新\"></a>更新</h4><p>如下是覆盖更新</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.update(&#123;更新的条件&#125;,&#123;更新的内容&#125;)</code></pre>\n\n<p>如下才是局部更新</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.update(&#123;更新的条件&#125;,&#123;$set:&#123;更新的内容&#125;&#125;)</code></pre>\n\n<p>默认是只修改找到的第一条数据，若想修改全部</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.update(&#123;更新的条件&#125;,&#123;$set:&#123;更新的内容&#125;&#125;,&#123;multi:true&#125;)</code></pre>\n\n<p>使某个字段自增1</p>\n<pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.update(&#123;更新的条件&#125;,&#123;$inc:&#123;XXX:NumberInt(1)&#125;&#125;)</code></pre>\n\n<h4 id=\"删除\"><a href=\"#删除\" class=\"headerlink\" title=\"删除\"></a>删除</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.remove(&#123;删除的条件&#125;)\n\ndb.comment.remove(&#123;&#125;) #删除全部\n\n#以上是过时的方法，下面是新的\nuse 数据库名\ndb.文档名.deleteOne(&#123;&quot;uid&quot;:&quot;123&quot;&#125;)\n\ndb.文档名.deleteMany(&#123;&quot;sex&quot;:&quot;男&quot;&#125;) #删多个满足条件的\n\ndb.文档名.deleteMany(&#123;&#125;) #删所有</code></pre>\n\n<h3 id=\"索引\"><a href=\"#索引\" class=\"headerlink\" title=\"索引\"></a>索引</h3><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.getIndexs() #查看索引\n\ndb.comment.createIndex(keys,options) #查看索引 options里常用的是name：指定索引名称和unique指定是否是唯一索引</code></pre>\n\n<h4 id=\"单字段索引\"><a href=\"#单字段索引\" class=\"headerlink\" title=\"单字段索引\"></a>单字段索引</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.createIndex(&#123;&quot;userId&quot;:1&#125;) #给userId字段添加一个升序的单字段索引</code></pre>\n\n<h4 id=\"复合索引\"><a href=\"#复合索引\" class=\"headerlink\" title=\"复合索引\"></a>复合索引</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.createIndex(&#123;&quot;userId&quot;:1,&quot;age&quot;:-1&#125;) #给userId字段添加一个升序的索引,age为降序的索引</code></pre>\n\n<h4 id=\"其他索引\"><a href=\"#其他索引\" class=\"headerlink\" title=\"其他索引\"></a>其他索引</h4><img src=\"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/image-20221122105945634.png\" alt=\"image-20221122105945634\" style=\"zoom:67%;\" />\n\n<h4 id=\"删除索引\"><a href=\"#删除索引\" class=\"headerlink\" title=\"删除索引\"></a>删除索引</h4><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.dropIndex(&#123;&quot;userId&quot;:1&#125;) #删除userId字段的升序的索引\n\ndb.comment.dropIndexes() #删除所有索引</code></pre>\n\n<h3 id=\"性能检查\"><a href=\"#性能检查\" class=\"headerlink\" title=\"性能检查\"></a>性能检查</h3><pre class=\"line-numbers language-cmd\" data-language=\"cmd\"><code class=\"language-cmd\">db.comment.find(xxx).explain()</code></pre>\n\n<h4 id=\"覆盖查询\"><a href=\"#覆盖查询\" class=\"headerlink\" title=\"覆盖查询\"></a>覆盖查询</h4><p>类似于MySQL中的覆盖索引</p>\n<p>就是查询的字段正是索引的字段</p>\n<h2 id=\"整合到SpringBoot\"><a href=\"#整合到SpringBoot\" class=\"headerlink\" title=\"整合到SpringBoot\"></a>整合到SpringBoot</h2><p>依赖：</p>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-data-mongodb&lt;&#x2F;artifactId&gt;\n&lt;&#x2F;dependency&gt;</code></pre>\n\n<p>编写配置：</p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\"># 应用名称\nspring:\n  application:\n    name: mongotest\n  data:\n    mongodb:\n      database: mytest\n      host: 127.0.0.1\n      port: 27017\n#      username: 如果有\n#      password: 如果有\nserver:\n  port: 8990</code></pre>\n\n<p>创建实体类，并指定文档名</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">@Document(collection &#x3D; &quot;user&quot;) &#x2F;&#x2F;可以省略，省略的话默认文档名为实体类的小写名\n@Data\npublic class User &#123;\n\n    &#x2F;&#x2F;mongoDB里自带的id为字符串！！！！！！！！！！！！\n    public String id;\n\n    @Field(&quot;name&quot;)\n    public String name;\n\n    public Integer sex;\n\n&#x2F;&#x2F;    @Indexed 添加单字段索引\n    public Long compId;\n\n    public String phone;\n&#125;</code></pre>\n\n<p>注入模板类：</p>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">@Autowired\nprivate MongoTemplate mongoTemplate;</code></pre>\n\n<h3 id=\"基本增添：\"><a href=\"#基本增添：\" class=\"headerlink\" title=\"基本增添：\"></a>基本增添：</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">@GetMapping(&quot;&#x2F;save&quot;)\npublic String save() &#123;\n    User user &#x3D; new User();\n    user.setName(&quot;CleWM&quot;);\n    user.setSex(1);\n    user.setCompId(10001L);\n    user.setPhone(&quot;18083822909&quot;);\n    &#x2F;&#x2F;insert和save的区别？\n    &#x2F;&#x2F;insert: 若新增数据的主键已经存在，则会抛 org.springframework.dao.DuplicateKeyException 异常提示主键重复，不保存当前数据。\n    &#x2F;&#x2F;save: 若新增数据的主键已经存在，则会对当前已经存在的数据进行修改操作\n    User insert &#x3D; mongoTemplate.insert(user);\n    return insert.getId().toString();\n&#125;</code></pre>\n\n<h3 id=\"基本查询：\"><a href=\"#基本查询：\" class=\"headerlink\" title=\"基本查询：\"></a>基本查询：</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">@GetMapping(&quot;&#x2F;get&quot;)\npublic String get() &#123;\n    Query query &#x3D; new Query();\n    query.addCriteria(Criteria.where(&quot;name&quot;).is(&quot;CleWM&quot;));\n    List&lt;User&gt; res &#x3D; mongoTemplate.find(query, User.class);\n    return res.get(0).toString();\n&#125;</code></pre>\n\n<h3 id=\"基本删除：\"><a href=\"#基本删除：\" class=\"headerlink\" title=\"基本删除：\"></a>基本删除：</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">mongoTemplate.remove(obj)\n    \n&#x2F;&#x2F;根据条件删除\nQuery query &#x3D; new Query();\nquery.addCriteria(Criteria.where(&quot;id&quot;).is(commentId));\nComment res &#x3D; mongoTemplate.findAndRemove(query, Comment.class);</code></pre>\n\n<h3 id=\"基本修改：\"><a href=\"#基本修改：\" class=\"headerlink\" title=\"基本修改：\"></a>基本修改：</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">Query query &#x3D; new Query();\nquery.addCriteria(Criteria.where(&quot;id&quot;).is(commentId));\nComment res &#x3D; mongoTemplate.findAndRemove(query, Comment.class);\n\nUpdate update &#x3D; new Update();\nupdate.set(&quot;key&quot;,&quot;value&quot;);\nmongoTemplate.updateFirst(query,update,Comment.class);</code></pre>\n\n<h3 id=\"排序\"><a href=\"#排序\" class=\"headerlink\" title=\"排序\"></a>排序</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">&#x2F;&#x2F;实体类的字段需要实现Comparable接口，并重写方法，如下，注意，o和this的位置不能颠倒，否则升序和降序也会反过来。\n    @Override\n    public int compareTo(@NotNull Comment o) &#123;\n        return o.getLikes().compareTo(this.getLikes());\n    &#125;</code></pre>\n\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">@Override\npublic List getList(CommentFuzzySearchDTO commentFuzzySearchDTO) &#123;\n    Query query &#x3D; new Query().with(Sort.by(&quot;likes&quot;).descending()); &#x2F;&#x2F;降序排序\n    query.addCriteria(Criteria.where(&quot;item_id&quot;).is(commentFuzzySearchDTO.getItemId()));\n    Integer curr &#x3D; commentFuzzySearchDTO.getCurr();\n    Integer pageSize &#x3D; commentFuzzySearchDTO.getPageSize();\n    List&lt;Comment&gt; commentList &#x3D; mongoTemplate.find(query, Comment.class)\n            .stream().skip((curr - 1) * pageSize).limit(pageSize).sorted().collect(Collectors.toList());\n    return commentList;\n&#125;</code></pre>\n\n<h3 id=\"自增\"><a href=\"#自增\" class=\"headerlink\" title=\"自增\"></a>自增</h3><pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">public Boolean likeInc(String commentId) &#123;\n    Query query &#x3D; new Query();\n    query.addCriteria(Criteria.where(&quot;_id&quot;).is(commentId));\n    Update update &#x3D; new Update();\n    update.inc(&quot;likes&quot;);\n    UpdateResult updateResult &#x3D; mongoTemplate.updateFirst(query, update, Comment.class);\n    long modifiedCount &#x3D; updateResult.getModifiedCount();\n    return modifiedCount &gt; 0;\n&#125;</code></pre>\n\n<h3 id=\"更多使用\"><a href=\"#更多使用\" class=\"headerlink\" title=\"更多使用\"></a>更多使用</h3><p>参考<a href=\"https://blog.csdn.net/qq_36331657/article/details/116431191\">https://blog.csdn.net/qq_36331657/article/details/116431191</a></p>\n<p><a href=\"https://blog.csdn.net/weixin_40392053/article/details/120265736\">https://blog.csdn.net/weixin_40392053/article/details/120265736</a></p>\n<h2 id=\"副本集\"><a href=\"#副本集\" class=\"headerlink\" title=\"副本集\"></a>副本集</h2><p>三个节点：</p>\n<ul>\n<li>主节点，Primary</li>\n<li>从节点，Slave </li>\n<li>选举节点，A也属于Slave，无法成为主节点</li>\n</ul>\n<h3 id=\"触发选举条件：\"><a href=\"#触发选举条件：\" class=\"headerlink\" title=\"触发选举条件：\"></a>触发选举条件：</h3><img src=\"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/image-20221122110005391.png\" alt=\"image-20221122110005391\" style=\"zoom:67%;\" />\n","text":"MongoDB概念一种非关系型数据库(NoSQL) 应用场景：高并发的、需要低延时的，对事务要求、安全性不是很高的场景。 和Reids的区别？Redis主要把数据存储在内存中，其“缓存”的性质远大于其“数据存储“的性质，其中数据的增删改查也只是像变量操作一样简单； MongoDB...","link":"","photos":[],"count_time":{"symbolsCount":"8.2k","symbolsTime":"7 mins."},"categories":[{"name":"技术","slug":"技术","count":6,"path":"api/categories/技术.json"},{"name":"分布式","slug":"技术/分布式","count":4,"path":"api/categories/技术/分布式.json"},{"name":"中间件","slug":"技术/分布式/中间件","count":2,"path":"api/categories/技术/分布式/中间件.json"},{"name":"数据库","slug":"技术/分布式/中间件/数据库","count":1,"path":"api/categories/技术/分布式/中间件/数据库.json"}],"tags":[{"name":"Java","slug":"Java","count":6,"path":"api/tags/Java.json"},{"name":"分布式存储引擎","slug":"分布式存储引擎","count":1,"path":"api/tags/分布式存储引擎.json"},{"name":"高并发","slug":"高并发","count":1,"path":"api/tags/高并发.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#MongoDB\"><span class=\"toc-text\">MongoDB</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%A6%82%E5%BF%B5\"><span class=\"toc-text\">概念</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%92%8CReids%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F\"><span class=\"toc-text\">和Reids的区别？</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%AF%E8%AF%AD%E5%AF%B9%E6%AF%94\"><span class=\"toc-text\">术语对比</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Windows%E5%AE%89%E8%A3%85-%E5%90%AF%E5%8A%A8\"><span class=\"toc-text\">Windows安装&#x2F;启动</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Linux%E5%AE%89%E8%A3%85-%E5%90%AF%E5%8A%A8\"><span class=\"toc-text\">Linux安装&#x2F;启动</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2\"><span class=\"toc-text\">图形化界面</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">使用</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\">数据库</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%9B%86%E5%90%88\"><span class=\"toc-text\">集合</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%87%E6%A1%A3\"><span class=\"toc-text\">文档</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%96%87%E6%A1%A3%E7%9A%84id%E5%80%BC%E5%BF%85%E9%A1%BB%E4%B8%BA%E5%AD%97%E7%AC%A6%E4%B8%B2-%E4%B8%8D%E6%98%AF%E6%95%B0%E5%AD%97\"><span class=\"toc-text\">文档的id值必须为字符串!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!不是数字</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E8%AF%A2-%E6%8F%92%E5%85%A5\"><span class=\"toc-text\">查询&#x2F;插入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%99%AE%E9%80%9A%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">普通查询</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E7%BB%9F%E8%AE%A1%E6%9F%A5%E8%AF%A2-count\"><span class=\"toc-text\">统计查询 count</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2-limt-skip\"><span class=\"toc-text\">分页查询 limt&#x2F;skip</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%8E%92%E5%BA%8F-sort\"><span class=\"toc-text\">排序 sort</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%AD%A3%E5%88%99%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">正则查询 &#x2F; &#x2F;</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%AF%94%E8%BE%83%E6%9F%A5%E8%AF%A2-gt-lt\"><span class=\"toc-text\">比较查询 gt&#x2F;lt</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%8C%85%E5%90%AB%E6%9F%A5%E8%AF%A2-in-nin\"><span class=\"toc-text\">包含查询 in&#x2F;nin</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E5%A4%9A%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2-and-or\"><span class=\"toc-text\">多条件查询 and&#x2F;or</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Try-catch%E5%8C%85%E8%A3%B9%E6%8F%92%E5%85%A5%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">Try catch包裹插入语句</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%9B%B4%E6%96%B0\"><span class=\"toc-text\">更新</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%88%A0%E9%99%A4\"><span class=\"toc-text\">删除</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">索引</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%8D%95%E5%AD%97%E6%AE%B5%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">单字段索引</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">复合索引</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">其他索引</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">删除索引</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%80%A7%E8%83%BD%E6%A3%80%E6%9F%A5\"><span class=\"toc-text\">性能检查</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%A6%86%E7%9B%96%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">覆盖查询</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%B4%E5%90%88%E5%88%B0SpringBoot\"><span class=\"toc-text\">整合到SpringBoot</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E5%A2%9E%E6%B7%BB%EF%BC%9A\"><span class=\"toc-text\">基本增添：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2%EF%BC%9A\"><span class=\"toc-text\">基本查询：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E5%88%A0%E9%99%A4%EF%BC%9A\"><span class=\"toc-text\">基本删除：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E4%BF%AE%E6%94%B9%EF%BC%9A\"><span class=\"toc-text\">基本修改：</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%8E%92%E5%BA%8F\"><span class=\"toc-text\">排序</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%87%AA%E5%A2%9E\"><span class=\"toc-text\">自增</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9B%B4%E5%A4%9A%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">更多使用</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%89%AF%E6%9C%AC%E9%9B%86\"><span class=\"toc-text\">副本集</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%A7%A6%E5%8F%91%E9%80%89%E4%B8%BE%E6%9D%A1%E4%BB%B6%EF%BC%9A\"><span class=\"toc-text\">触发选举条件：</span></a></li></ol></li></ol></li></ol>","author":{"name":"CleWm","slug":"blog-author","avatar":"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/467a8fb87ff3c96961397cd53bcc2c0.jpg","link":"/","description":"记录学习 & 生活的碎片，欢迎参观！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"分布式ID","uid":"cebe9414641c5085bfbfba73b0875917","slug":"Java/分布式ID","date":"2022-07-20T01:57:56.986Z","updated":"2022-11-03T23:44:08.464Z","comments":true,"path":"api/articles/Java/分布式ID.json","keywords":null,"cover":"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/4k%20%E7%BE%8E%E5%A5%B3%20%E7%99%BD%E8%89%B2%E5%8F%A4%E8%A3%85%20%E5%8F%A4%E9%A3%8E%20%D0%A1%CF%AA%20%E7%80%91%E5%B8%83%20%E5%B2%A9%E7%9F%B3%20%E9%AB%98%E6%B8%85%20%E5%A3%81%E7%BA%B8_%E5%BD%BC%E5%B2%B8%E5%9B%BE%E7%BD%91.jpg","text":" 分布式ID雪花算法 共64位，这三个部分是保证唯一性的重要条件，缺一不可，但是可以根据业务需要调整他们占用的位数，添加其他的信息，比如业务代码。 工作流程 还需要配合Redis一起使用 雪花算法生成ID配合Redis使用实现集群唯一ID(长度为18位)&#x2F;** * @a...","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"技术","slug":"技术","count":6,"path":"api/categories/技术.json"},{"name":"分布式","slug":"技术/分布式","count":4,"path":"api/categories/技术/分布式.json"}],"tags":[{"name":"Java","slug":"Java","count":6,"path":"api/tags/Java.json"},{"name":"分布式","slug":"分布式","count":3,"path":"api/tags/分布式.json"}],"author":{"name":"CleWm","slug":"blog-author","avatar":"https://md-1259549904.cos.ap-shanghai.myqcloud.com/img/467a8fb87ff3c96961397cd53bcc2c0.jpg","link":"/","description":"记录学习 & 生活的碎片，欢迎参观！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{}}